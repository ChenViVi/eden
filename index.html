<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>Eden</title>
  <script src="js/jquery-3.3.1.min.js"></script>
  <link rel="stylesheet" href="css/materialize.min.css">
  <script src="js/materialize.min.js"></script>
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.10/css/all.css" integrity="sha384-+d0P83n9kaQMCwj8F4RJB66tzIwOKmrdb46+porD/OvrJ+37WqIM7UoBtwHO6Nlg"
    crossorigin="anonymous">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script src="https://cdn.bootcss.com/showdown/1.5.0/showdown.min.js"></script>
  <link rel="stylesheet" href="css/default.css">
  <script src="js/highlight.pack.js"></script>
  <style>
    .tabs .indicator {
      background-color: #ffffff;
    }

    h1,
    h2,
    h3,
    h4,
    h5 {
      color: rgb(255, 128, 171)
    }

    h1 {
      font-size: 3.2rem;
    }

    h2 {
      font-size: 2.56rem;
    }

    h3 {
      font-size: 2.02rem;
    }

    h4 {
      font-size: 1.58rem;
    }

    h5 {
      font-size: 1.24rem;
    }

    h6 {
      font-size: 1rem;
    }
  </style>
  <script type="text/javascript">
    var user_name = 'ChenViVi';
    var repos_name = 'eden';
    var page = 1;
    var page_size = 10;
    var articles = new Map();
    var converter = new showdown.Converter();
    var article_list;
    var article_content;
    $(document).ready(function () {
      article_list = $('#article-list');
      article_content = $('#article-list');
      $(".button-collapse").sideNav();
      load_more();
    });
    function load_more() {
      $.ajax({
        url: "https://api.github.com/repos/" + user_name + "/" + repos_name + "/issues",
        type: "get",
        dataType: 'json',
        data: ("milestone=1" + "&creator=" + user_name + "&state=open" + "&page=" + page + "&per_page=" + page_size),
        async: false,
        success: function (response) {
          for (var i = 0; i < response.length; i++) {
            var article = response[i];
            articles.set(article.number, article);
            var created_at = article.updated_at.split("T");
            var updated_date = article.updated_at.split("T");
            article_list.append(
              '<div class="card hoverable z-depth-2 col s12">' +
              '<div class="card-content white-text">' +
              '<a href="#article' + article.id + '" class="card-title pink-text accent-1 article-title truncate" data-number="' + article.number + '" onclick=load_content(' + article.number + ')>' + article.title + '</a>' +
              '<p class="grey-text text-darken-2">' + '创建时间：' + created_at[0] + " " + created_at[1].substring(0, created_at[1].length - 1) + '</p>' +
              '<p class="grey-text text-darken-2">' + '修改时间：' + updated_date[0] + " " + updated_date[1].substring(0, updated_date[1].length - 1) + '</p>' +
              '</div>' +
              '<div class="card-action" data-id="' + article.id + '">' +
              '</div>' +
              '</div>'
            );
            var labels = article.labels;
            var labels_content = $('.card-action[data-id=' + article.id + ']');
            for (var j = 0; j < labels.length; j++)
              labels_content.append('<div class="chip" style="background-color:#' + labels[j].color + ';color:#ffffff">' + labels[j].name + '</div>');
          }
          page++;
        },
        error: function (jqXHR, textStatus, errorThrown) {
          Materialize.toast("未知错误", 3000);
        }
      });
    }

    function load_content(number) {
      $('.container').html(
        '<div class="card-panel row" id="article-content">' +
        converter.makeHtml(articles.get(number).body) +
        '</div>'
      );
      $('img').addClass('col s12');
      $('h1').addClass('col s12');
      $('h2').addClass('col s12');
      $('h3').addClass('col s12');
      $('h4').addClass('col s12');
      $('h5').addClass('col s12');
      $('p').addClass('col s12');
      $('pre').addClass('col s12');
      $('code').addClass('col s12');
      $('blockquote').addClass('col s12');
      $('pre code').each(function (i, block) {
        hljs.highlightBlock(block);
      });
    }
  </script>
</head>

<body>
  <nav>
    <div class="nav-wrapper pink accent-1">
      <a href="#!" class="brand-logo">&nbsp;&nbsp;Eden</a>
      <a href="#" data-activates="mobile-demo" class="button-collapse">
        <i class="material-icons">menu</i>
      </a>
      <ul class="right hide-on-med-and-down">
        <li class="active">
          <a href="index.html">
            <i class="material-icons left">home</i>主页</a>
        </li>
        <li>
          <a href="bibi.html">
            <i class="material-icons left">send</i>动态</a>
        </li>
        <li>
          <a href="code.html">
            <i class="material-icons left">code</i>项目</a>
        </li>
        <li>
          <a href="music.html">
            <i class="material-icons left">library_music</i>音乐</a>
        </li>
        <li>
          <a href="game.html">
            <i class="material-icons left">games</i>游戏</a>
        </li>
        <li>
          <a href="about.html">
            <i class="material-icons left">info</i>了解我</a>
        </li>
        <li>
          <a href="friends.html">
            <i class="material-icons left">mood</i>友链</a>
        </li>
      </ul>
      <ul class="side-nav" id="mobile-demo">
        <li class="active">
          <a href="index.html">
            <i class="material-icons left">home</i>主页</a>
        </li>
        <li>
          <a href="bibi.html">
            <i class="material-icons left">send</i>动态</a>
        </li>
        <li>
          <a href="code.html">
            <i class="material-icons left">code</i>项目</a>
        </li>
        <li>
          <a href="music.html">
            <i class="material-icons left">library_music</i>音乐</a>
        </li>
        <li>
          <a href="game.html">
            <i class="material-icons left">games</i>游戏</a>
        </li>
        <li>
          <a href="about.html">
            <i class="material-icons left">info</i>了解我</a>
        </li>
        <li>
          <a href="friends.html">
            <i class="material-icons left">mood</i>友链</a>
        </li>
      </ul>
    </div>
  </nav>
  <div class="container">
    <div id="article-list" class="row"></div>
    <div class="row center" style="margin-bottom: 20px;">
      <a id="btn-load-more" class="waves-effect waves-light btn  pink accent-1" onclick="load_more()">加载更多</a>
    </div>
  </div>
</body>

</html>